
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vision v1 | The Original Glass Browser</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #000000;
            --accent: #d1b8ff;
            --accent-glow: rgba(139, 92, 246, 0.4);
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
            --tab-zoom: 1;
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            overflow: hidden;
            background-color: var(--bg-main);
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            user-select: none;
            height: 100vh;
            transition: background 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .glass-dark {
            background: rgba(10, 10, 12, 0.85);
            backdrop-filter: blur(50px) saturate(180%);
            border-bottom: 1px solid var(--border);
        }

        .glass-tab-strip {
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .tab {
            height: 40px;
            min-width: 160px;
            max-width: 240px;
            padding: 0 16px;
            display: flex;
            align-items: center;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border);
            border-bottom: none;
            border-top-left-radius: 14px;
            border-top-right-radius: 14px;
            color: rgba(255, 255, 255, 0.3);
            margin-right: 4px;
            position: relative;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.6);
        }

        .tab.active {
            background: #0a0a0b;
            color: var(--accent);
            border-top: 2px solid var(--accent);
            box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.8);
            z-index: 10;
        }

        .tool-btn { 
            width: 36px;
            height: 36px;
            border-radius: 12px; 
            color: rgba(255, 255, 255, 0.4); 
            transition: all 0.3s; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            border: 1px solid transparent;
        }
        .tool-btn:hover { 
            background: rgba(255, 255, 255, 0.08); 
            color: white; 
            border-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }
        .tool-btn.active { 
            color: var(--accent); 
            background: rgba(139, 92, 246, 0.1); 
            border-color: rgba(139, 92, 246, 0.2);
        }

        .omnibox {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid var(--border);
            border-radius: 16px;
            height: 40px;
        }
        .omnibox:focus-within {
            border-color: var(--accent);
            background: rgba(255, 255, 255, 0.07);
            box-shadow: 0 0 30px var(--accent-glow);
        }

        .side-panel {
            position: fixed;
            top: 112px;
            right: 0;
            bottom: 32px;
            width: 400px;
            background: rgba(5, 5, 8, 0.94);
            backdrop-filter: blur(60px) saturate(200%);
            border-left: 1px solid var(--border);
            transform: translateX(100%);
            transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 100;
            box-shadow: -40px 0 80px rgba(0,0,0,0.9);
        }
        .side-panel.open { transform: translateX(0); }

        .viewport-wrapper {
            flex: 1;
            overflow: hidden;
            position: relative;
            background: #000;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
            transform-origin: top left;
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        #more-menu {
            position: absolute;
            top: 104px;
            right: 16px;
            width: 240px;
            background: rgba(12, 12, 14, 0.98);
            backdrop-filter: blur(40px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 10px;
            display: none;
            flex-direction: column;
            gap: 4px;
            z-index: 1000;
            box-shadow: 0 30px 60px rgba(0,0,0,0.9);
        }

        .menu-item {
            padding: 12px 14px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            color: rgba(255,255,255,0.6);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .menu-item:hover { background: rgba(255,255,255,0.06); color: white; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .zoom-pill {
            font-size: 10px;
            font-weight: 900;
            background: var(--accent);
            color: black;
            padding: 2px 8px;
            border-radius: 6px;
            margin-left: 10px;
        }
    </style>
</head>
<body class="flex flex-col">
    <div id="tab-strip" class="glass-tab-strip h-12 flex items-end px-4 gap-0 overflow-x-auto no-scrollbar z-20 pt-2">
        <button id="add-tab-btn" class="mb-1.5 ml-2 p-1.5 rounded-lg hover:bg-white/10 transition-colors text-zinc-600">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
        </button>
    </div>

    <div class="h-14 px-4 flex items-center gap-4 glass-dark z-20">
        <div class="flex items-center gap-1">
            <button class="tool-btn" id="back-btn"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="15 18 9 12 15 6"></polyline></svg></button>
            <button class="tool-btn" id="forward-btn"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg></button>
            <button id="reload-btn" class="tool-btn"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 4v6h-6"></path><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg></button>
        </div>

        <div class="flex-1">
            <div class="omnibox w-full flex items-center px-5 group">
                <div id="url-favicon" class="w-4 h-4 mr-4 shrink-0 flex items-center justify-center opacity-70">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                </div>
                <input id="address-input" type="text" placeholder="Search or type URL..." class="bg-transparent border-none outline-none w-full text-[14px] font-semibold text-white placeholder-zinc-700">
                <div id="current-zoom-label" class="zoom-pill hidden">100%</div>
            </div>
        </div>

        <div class="flex items-center gap-1">
            <button id="zoom-out-btn" class="tool-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="5" y1="12" x2="19" y2="12"></line></svg></button>
            <button id="zoom-in-btn" class="tool-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg></button>
            <div class="w-[1px] h-6 bg-white/10 mx-2"></div>
            <button id="games-btn" class="tool-btn" onclick="vision.navigate('games.html')"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect x="2" y="6" width="20" height="12" rx="2"/><path d="M6 12h4m-2-2v4m5-2h.01m2.99 0h.01"/></svg></button>
            <button id="music-btn" class="tool-btn side-trigger" data-src="music.html"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg></button>
            <button id="bookmarks-btn" class="tool-btn side-trigger" data-src="bookmarks.html"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"></path></svg></button>
            <button id="settings-btn" class="tool-btn side-trigger" data-src="settings.html"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1-2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg></button>
            <button id="dots-btn" class="tool-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><circle cx="12" cy="12" r="1.5"></circle><circle cx="12" cy="5" r="1.5"></circle><circle cx="12" cy="19" r="1.5"></circle></svg></button>
        </div>
    </div>

    <div id="viewport-container" class="viewport-wrapper"></div>

    <div id="more-menu">
        <div class="menu-item" onclick="vision.addTab()">New Tab</div>
        <div class="menu-item" onclick="vision.navigate('games.html')">Arcade Mode</div>
        <div class="menu-item" onclick="vision.setZoom(1)">Reset Zoom</div>
        <div class="w-full h-[1px] bg-white/5 my-1.5"></div>
        <div class="menu-item text-red-400" onclick="vision.wipeMemory()">Purge Memory</div>
    </div>

    <div id="side-panel" class="side-panel flex flex-col">
        <div class="p-4 border-b border-white/10 flex items-center justify-between bg-black/40">
            <span id="side-panel-title" class="text-[10px] font-black uppercase tracking-[0.3em] text-zinc-400">System Utility</span>
            <button id="close-side-btn" class="text-zinc-600 hover:text-white">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
        <div class="flex-1 overflow-hidden">
            <iframe id="side-panel-iframe" class="w-full h-full border-none" src="about:blank"></iframe>
        </div>
    </div>

    <div class="h-8 bg-black border-t border-white/5 flex items-center justify-between px-6 text-[9px] font-bold uppercase tracking-widest text-zinc-600">
        <div class="flex items-center gap-5">
            <div class="status-dot opacity-40"></div>
            <span>Vision OS v1.6</span>
            <div id="status-url" class="lowercase opacity-30 italic font-medium tracking-normal">vision://home</div>
        </div>
        <div id="status-clock">00:00:00</div>
    </div>

    <script type="module">
        class VisionEngine {
            constructor() {
                this.tabs = [];
                this.activeTabId = null;
                this.dom = {
                    strip: document.getElementById('tab-strip'),
                    viewport: document.getElementById('viewport-container'),
                    address: document.getElementById('address-input'),
                    statusUrl: document.getElementById('status-url'),
                    sidePanel: document.getElementById('side-panel'),
                    sideIframe: document.getElementById('side-panel-iframe'),
                    sideTitle: document.getElementById('side-panel-title'),
                    urlFavicon: document.getElementById('url-favicon'),
                    clock: document.getElementById('status-clock'),
                    moreMenu: document.getElementById('more-menu'),
                    zoomLabel: document.getElementById('current-zoom-label')
                };
                this.init();
            }

            init() {
                this.setupListeners();
                this.loadAesthetics();
                this.loadSession();
                setInterval(() => this.updateClock(), 1000);
                window.addEventListener('storage', () => this.loadAesthetics());
            }

            loadAesthetics() {
                const bg = localStorage.getItem('vision_wallpaper');
                if (bg) document.body.style.backgroundImage = `url(${bg})`;
                const accent = localStorage.getItem('vision_accent');
                if (accent) {
                    document.documentElement.style.setProperty('--accent', accent);
                    document.documentElement.style.setProperty('--accent-glow', accent + '33');
                }
            }

            setupListeners() {
                document.getElementById('add-tab-btn').onclick = () => this.addTab();
                document.getElementById('reload-btn').onclick = () => this.reloadActiveTab();
                document.getElementById('back-btn').onclick = () => this.getActiveTabIfr()?.contentWindow?.history.back();
                document.getElementById('forward-btn').onclick = () => this.getActiveTabIfr()?.contentWindow?.history.forward();
                document.getElementById('close-side-btn').onclick = () => this.toggleSidePanel(null, null, false);
                document.getElementById('dots-btn').onclick = (e) => {
                    e.stopPropagation();
                    this.dom.moreMenu.style.display = this.dom.moreMenu.style.display === 'flex' ? 'none' : 'flex';
                };
                document.getElementById('zoom-in-btn').onclick = () => this.adjustZoom(0.1);
                document.getElementById('zoom-out-btn').onclick = () => this.adjustZoom(-0.1);
                window.onclick = () => this.dom.moreMenu.style.display = 'none';
                document.querySelectorAll('.side-trigger').forEach(btn => {
                    btn.onclick = () => this.toggleSidePanel(btn.getAttribute('title') || 'Tool', btn.getAttribute('data-src'));
                });
                this.dom.address.onkeydown = (e) => {
                    if (e.key === 'Enter') this.navigate(this.dom.address.value);
                };
                window.onmessage = (e) => {
                    if (e.data.type === 'navigate') this.navigate(e.data.query);
                    if (e.data.type === 'update-settings') this.loadAesthetics();
                };
            }

            loadSession() {
                const saved = localStorage.getItem('vision_session_v1');
                if (saved) {
                    try {
                        const session = JSON.parse(saved);
                        if (session.tabs?.length) {
                            session.tabs.forEach(t => this.addTab(t.url, t.title, t.id, t.zoom));
                            this.switchTab(session.activeTabId || session.tabs[0].id);
                            return;
                        }
                    } catch (e) {}
                }
                this.addTab();
            }

            saveSession() {
                localStorage.setItem('vision_session_v1', JSON.stringify({
                    tabs: this.tabs.map(t => ({ id: t.id, url: t.url, title: t.title, zoom: t.zoom })),
                    activeTabId: this.activeTabId
                }));
            }

            addTab(url = 'newtab.html', title = 'Home', existingId = null, zoom = null) {
                const id = existingId || 'tab-' + Math.random().toString(36).substr(2, 9);
                const ifr = document.createElement('iframe');
                ifr.id = `ifr-${id}`;
                ifr.src = url;
                ifr.className = 'absolute top-0 left-0 hidden';
                this.dom.viewport.appendChild(ifr);

                const tabEl = document.createElement('div');
                tabEl.id = `el-${id}`;
                tabEl.className = 'tab group';
                tabEl.innerHTML = `<span class="truncate flex-1 font-bold">${title}</span>`;
                tabEl.onclick = () => this.switchTab(id);

                this.dom.strip.insertBefore(tabEl, document.getElementById('add-tab-btn'));
                let dZoom = parseFloat(localStorage.getItem('vision_default_zoom')) || 100;
                if (dZoom > 10) dZoom /= 100;

                this.tabs.push({ id, url, title, ifr, el: tabEl, zoom: zoom || dZoom });
                this.switchTab(id);
            }

            switchTab(id) {
                this.tabs.forEach(t => { t.ifr.classList.add('hidden'); t.el.classList.remove('active'); });
                const active = this.tabs.find(t => t.id === id);
                if (active) {
                    active.ifr.classList.remove('hidden');
                    active.el.classList.add('active');
                    this.activeTabId = id;
                    this.dom.address.value = active.url === 'newtab.html' ? '' : active.url;
                    this.dom.statusUrl.textContent = active.url;
                    this.updateZoomUI(active);
                    this.saveSession();
                }
            }

            adjustZoom(delta) {
                const active = this.tabs.find(t => t.id === this.activeTabId);
                if (active) {
                    active.zoom = Math.max(0.3, Math.min(3, active.zoom + delta));
                    this.updateZoomUI(active);
                    this.saveSession();
                }
            }

            setZoom(val) {
                const active = this.tabs.find(t => t.id === this.activeTabId);
                if (active) {
                    active.zoom = val;
                    this.updateZoomUI(active);
                    this.saveSession();
                }
            }

            updateZoomUI(tab) {
                const zoomValue = tab.zoom || 1.0;
                tab.ifr.style.transform = `scale(${zoomValue})`;
                tab.ifr.style.width = `${100 / zoomValue}%`;
                tab.ifr.style.height = `${100 / zoomValue}%`;
                const perc = Math.round(zoomValue * 100);
                this.dom.zoomLabel.textContent = `${perc}%`;
                this.dom.zoomLabel.classList.toggle('hidden', perc === 100);
            }

            navigate(input) {
                if (!this.activeTabId) return;
                const active = this.tabs.find(t => t.id === this.activeTabId);
                if (active) {
                    active.url = input;
                    active.ifr.src = input;
                    this.switchTab(active.id);
                }
            }

            reloadActiveTab() {
                const active = this.tabs.find(t => t.id === this.activeTabId);
                if (active) active.ifr.src = active.ifr.src;
            }

            getActiveTabIfr() {
                return this.tabs.find(t => t.id === this.activeTabId)?.ifr;
            }

            toggleSidePanel(title, src, force) {
                const isOpen = this.dom.sidePanel.classList.contains('open');
                if (isOpen && force === undefined) return this.dom.sidePanel.classList.remove('open');
                if (force === false) return this.dom.sidePanel.classList.remove('open');
                this.dom.sideTitle.textContent = title;
                this.dom.sideIframe.src = src;
                this.dom.sidePanel.classList.add('open');
            }

            wipeMemory() {
                if(confirm('Wipe all Vision data?')) {
                    localStorage.clear();
                    window.location.reload();
                }
            }

            updateClock() {
                this.dom.clock.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
            }
        }
        window.vision = new VisionEngine();
    </script>
</body>
</html>
