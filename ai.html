<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vision AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #fff; font-family: 'Inter', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .chat-container { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 16px; scrollbar-width: none; }
        .chat-container::-webkit-scrollbar { display: none; }
        .msg { max-width: 85%; padding: 12px 16px; border-radius: 18px; font-size: 13px; line-height: 1.5; }
        .msg.user { background: #1c1c1e; align-self: flex-end; border-bottom-right-radius: 4px; color: #e4e4e7; }
        .msg.ai { background: rgba(139, 92, 246, 0.1); align-self: flex-start; border-bottom-left-radius: 4px; border: 1px solid rgba(139, 92, 246, 0.2); }
        .input-area { padding: 20px; border-top: 1px solid rgba(255,255,255,0.05); background: #000; }
        .input-box { width: 100%; background: #1c1c1e; border: 1px solid rgba(255,255,255,0.1); border-radius: 14px; padding: 12px 16px; color: #fff; outline: none; transition: border-color 0.2s; }
        .input-box:focus { border-color: #8b5cf6; }
    </style>
</head>
<body>
    <div class="chat-container" id="chat">
        <div class="msg ai">Welcome to Vision AI. I'm your browsing assistant. Ask me to summarize a page, find information, or just chat.</div>
    </div>
    <div class="input-area">
        <input type="text" id="input" class="input-box" placeholder="Message Vision AI..." autocomplete="off">
    </div>

    <script type="module">
        import { GoogleGenAI } from "@google/genai";
        const input = document.getElementById('input');
        const chat = document.getElementById('chat');

        function addMsg(text, sender) {
            const el = document.createElement('div');
            el.className = `msg ${sender}`;
            el.textContent = text;
            chat.appendChild(el);
            chat.scrollTop = chat.scrollHeight;
            return el;
        }

        input.onkeydown = async (e) => {
            if (e.key === 'Enter' && input.value.trim()) {
                const query = input.value.trim();
                input.value = '';
                addMsg(query, 'user');
                
                const aiMsg = addMsg('Thinking...', 'ai');
                
                const apiKey = window.process?.env?.API_KEY;
                if (!apiKey) {
                    aiMsg.textContent = "Error: API Key not detected. Please verify your system configuration.";
                    return;
                }

                try {
                    const aiClient = new GoogleGenAI({ apiKey });
                    const response = await aiClient.models.generateContent({
                        model: 'gemini-3-flash-preview',
                        contents: query,
                        config: { 
                            systemInstruction: "You are Vision AI, a helpful browser assistant built into the Vision Browser. Be concise and friendly.",
                            thinkingConfig: { thinkingBudget: 0 }
                        }
                    });
                    aiMsg.textContent = response.text || "I'm sorry, I couldn't generate a response.";
                } catch (err) {
                    aiMsg.textContent = "Error: System connection restricted or model unavailable.";
                    console.error(err);
                }
            }
        };
    </script>
</body>
</html>
